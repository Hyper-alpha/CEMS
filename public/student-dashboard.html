<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - CEMS</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-calendar-alt"></i>
                <span>CEMS</span>
            </div>
            <div class="nav-menu">
                <a href="#dashboard" class="nav-link active">Dashboard</a>
                <a href="#events" class="nav-link">Events</a>
                <a href="#registrations" class="nav-link">My Events</a>
                <a href="#certificates" class="nav-link">Certificates</a>
                <!-- theme toggle removed from role dashboards -->
                <div class="user-menu">
                    <div class="user-dropdown" aria-label="User menu">
                        <button class="user-avatar" id="user-menu-toggle" aria-haspopup="true" aria-expanded="false">
                            <span id="user-initials">SU</span>
                        </button>
                        <div class="dropdown-menu">
                            <div class="user-info">
                                <span class="user-name" id="user-name">Loading...</span>
                                <span class="user-role">Student</span>
                            </div>
                            <a href="profile.html" class="dropdown-item">
                                <i class="fas fa-user"></i>
                                Profile
                            </a>
                            <a href="settings.html" class="dropdown-item">
                                <i class="fas fa-cog"></i>
                                Settings
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="#" class="dropdown-item" id="logout-btn">
                                <i class="fas fa-sign-out-alt"></i>
                                Logout
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="dashboard-section active">
            <div class="container">
                <div class="page-header">
                    <h1>Student Dashboard</h1>
                    <p>Welcome back! Here's what's happening with your events.</p>
                </div>

                <!-- Stats Cards -->
                <div class="stats-grid">
                    <div class="stat-card" role="button" tabindex="0" data-section="registrations">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="total-registrations">0</h3>
                            <p>Total Registrations</p>
                        </div>
                    </div>
                    <div class="stat-card" role="button" tabindex="0" data-section="registrations">
                        <div class="stat-icon">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="attended-events">0</h3>
                            <p>Events Attended</p>
                        </div>
                    </div>
                    <div class="stat-card" role="button" tabindex="0" data-section="events">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="upcoming-events">0</h3>
                            <p>Upcoming Events</p>
                        </div>
                    </div>
                    <div class="stat-card" role="button" tabindex="0" data-section="certificates">
                        <div class="stat-icon">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="average-rating">0</h3>
                            <p>Avg Rating Given</p>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <h2>Quick Actions</h2>
                    <div class="actions-grid">
                        <button class="action-card" data-section="events">
                            <i class="fas fa-search"></i>
                            <span>Browse Events</span>
                        </button>
                        <button class="action-card" data-section="registrations">
                            <i class="fas fa-list"></i>
                            <span>My Registrations</span>
                        </button>
                        <button class="action-card" data-section="certificates">
                            <i class="fas fa-certificate"></i>
                            <span>View Certificates</span>
                        </button>
                        <button class="action-card" data-action="showQRScanner">
                            <i class="fas fa-qrcode"></i>
                            <span>QR Scanner</span>
                        </button>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="recent-activity">
                    <h2>Recent Activity</h2>
                    <div class="activity-list" id="recent-activity">
                        <div class="loading">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>Loading activity...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="dashboard-section">
            <div class="container">
                <div class="page-header">
                    <h1>My Analytics</h1>
                    <p>Personal activity and event insights</p>
                </div>

                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h3>My Registrations (last 6 months)</h3>
                        <div class="chart-small" id="student-registrations-chart">
                            <div class="loading"><i class="fas fa-spinner fa-spin"></i><p>Loading...</p></div>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <h3>Events Attended</h3>
                        <div class="metric-large" id="student-attended">
                            <div class="loading"><i class="fas fa-spinner fa-spin"></i><p>Loading...</p></div>
                        </div>
                    </div>
                    <div class="analytics-card">
                        <h3>Certificates Earned</h3>
                        <div class="metric-large" id="student-certificates">
                            <div class="loading"><i class="fas fa-spinner fa-spin"></i><p>Loading...</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Events Section -->
        <section id="events" class="dashboard-section">
            <div class="container">
                <div class="page-header">
                    <h1>Browse Events</h1>
                    <p>Discover and register for exciting events</p>
                </div>

                <div class="events-filters">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" id="event-search" placeholder="Search events...">
                    </div>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">All Events</button>
                        <button class="filter-btn" data-filter="upcoming">Upcoming</button>
                        <button class="filter-btn" data-filter="this-week">This Week</button>
                    </div>
                </div>

                <div class="events-grid" id="events-grid">
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading events...</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- My Registrations Section -->
        <section id="registrations" class="dashboard-section">
            <div class="container">
                <div class="page-header">
                    <h1>My Registrations</h1>
                    <p>Manage your event registrations and attendance</p>
                </div>

                <div class="registrations-tabs">
                    <button class="tab-btn active" data-tab="upcoming">Upcoming</button>
                    <button class="tab-btn" data-tab="past">Past Events</button>
                    <button class="tab-btn" data-tab="all">All</button>
                </div>

                <div class="registrations-content">
                    <div class="tab-content active" id="upcoming-tab">
                        <div class="registrations-list" id="upcoming-registrations">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading upcoming events...</p>
                            </div>
                        </div>
                    </div>
                    <div class="tab-content" id="past-tab">
                        <div class="registrations-list" id="past-registrations">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading past events...</p>
                            </div>
                        </div>
                    </div>
                    <div class="tab-content" id="all-tab">
                        <div class="registrations-list" id="all-registrations">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>Loading all events...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Certificates Section -->
        <section id="certificates" class="dashboard-section">
            <div class="container">
                <div class="page-header">
                    <h1>My Certificates</h1>
                    <p>View and download your event certificates</p>
                </div>

                <div class="certificates-grid" id="certificates-grid">
                    <!-- Sample certificate card (visible as an example) -->
                    <div class="certificate-card" data-cert-id="sample-cert-1">
                        <div class="cert-thumb">
                            <!-- using an event image as a placeholder thumbnail -->
                            <img src="/uploads/events/Career Fair.png" alt="Sample Certificate" />
                        </div>
                        <div class="cert-info">
                            <h3>Certificate of Participation</h3>
                            <p class="cert-event">Career Fair</p>
                            <p class="cert-issued">Issued: Jan 15, 2025</p>
                            <div class="cert-actions">
                                <a href="/uploads/passes/pass_0b2d1627-f921-4ffd-97a6-151be221d530.pdf" target="_blank" class="btn btn-outline">View</a>
                                <a href="/uploads/passes/pass_0b2d1627-f921-4ffd-97a6-151be221d530.pdf" download class="btn btn-primary">Download</a>
                            </div>
                        </div>
                    </div>
                    <!-- End sample certificate -->
                </div>
            </div>
        </section>
    </main>

    <!-- Event Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-event-title"></h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="event-details">
                    <div class="event-image">
                        <img id="modal-event-image" src="" alt="Event Image">
                    </div>
                    <div class="event-info">
                        <div class="event-meta">
                            <div class="meta-item">
                                <i class="fas fa-calendar"></i>
                                <span id="modal-event-date"></span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-clock"></i>
                                <span id="modal-event-time"></span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span id="modal-event-venue"></span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-user"></i>
                                <span id="modal-event-organizer"></span>
                            </div>
                        </div>
                        <div class="event-description">
                            <p id="modal-event-description"></p>
                        </div>
                        <div class="event-actions">
                            <button id="register-btn" class="btn btn-primary">Register for Event</button>
                            <button id="unregister-btn" class="btn btn-outline" style="display: none;">Unregister</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Scanner Modal -->
    <div id="qr-scanner-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>QR Code Scanner</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <div class="qr-scanner">
                    <div id="qr-reader" style="width: 100%;"></div>
                    <p>Scan a QR code to check in to an event</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Event Feedback</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="feedback-form">
                    <div class="form-group">
                        <label>Rating</label>
                        <div class="rating-input">
                            <input type="radio" name="rating" value="5" id="rating-5">
                            <label for="rating-5"><i class="fas fa-star"></i></label>
                            <input type="radio" name="rating" value="4" id="rating-4">
                            <label for="rating-4"><i class="fas fa-star"></i></label>
                            <input type="radio" name="rating" value="3" id="rating-3">
                            <label for="rating-3"><i class="fas fa-star"></i></label>
                            <input type="radio" name="rating" value="2" id="rating-2">
                            <label for="rating-2"><i class="fas fa-star"></i></label>
                            <input type="radio" name="rating" value="1" id="rating-1">
                            <label for="rating-1"><i class="fas fa-star"></i></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="feedback-text">Comments (Optional)</label>
                        <textarea id="feedback-text" rows="4" placeholder="Share your thoughts about the event..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-outline" onclick="hideModal('feedback-modal')">Cancel</button>
                        <button type="submit" class="btn btn-primary">Submit Feedback</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Registration Pass Modal -->
    <div id="registration-pass-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Registration Pass</h3>
                <span class="close" data-close="registration-pass-modal">&times;</span>
            </div>
            <div class="modal-body" id="registration-pass-body">
                <!-- Filled dynamically -->
                <div class="pass-card" id="pass-card" style="max-width:520px;margin:0 auto;text-align:left;">
                    <div style="display:flex;justify-content:space-between;align-items:center;">
                        <div>
                            <h2 id="pass-event-title"></h2>
                            <p id="pass-event-datetime"></p>
                            <p id="pass-venue"></p>
                        </div>
                        <div style="text-align:center;">
                            <img id="pass-qr-image" src="" alt="QR Code" style="width:140px;height:140px;border:1px solid #ddd;padding:6px;background:#fff;" />
                        </div>
                    </div>
                    <hr />
                    <div>
                        <h4>Attendee</h4>
                        <p id="pass-user-name"></p>
                        <p id="pass-user-email"></p>
                        <p id="pass-user-studentid"></p>
                    </div>
                    <div style="margin-top:12px;text-align:right;">
                        <button class="btn btn-outline" onclick="hideModal('registration-pass-modal')">Close</button>
                        <button class="btn btn-primary" id="print-pass-btn">Print Pass</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/theme.js"></script>
    <script src="js/api.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/student-dashboard.js"></script>
</body>
</html>


